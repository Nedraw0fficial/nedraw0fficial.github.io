<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ‘¾ SPACE INVADERS - Retro Space Arcade</title>
    <link rel="stylesheet" href="style.css">
    <style>
        #gameCanvas {
            display: block;
            margin: 2rem auto;
            border: 4px solid var(--neon-cyan);
            box-shadow: 
                0 0 20px var(--neon-cyan),
                0 0 40px var(--neon-cyan),
                inset 0 0 30px rgba(0, 240, 255, 0.2);
            background: #000;
        }
        
        .game-controls {
            text-align: center;
            margin: 2rem 0;
            font-family: 'Press Start 2P', cursive;
        }
        
        .game-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 2rem;
            margin: 2rem 0;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
        }
        
        .game-info div {
            padding: 1rem 2rem;
            background: rgba(0, 240, 255, 0.1);
            border: 3px solid var(--neon-cyan);
            box-shadow: 0 0 15px var(--neon-cyan);
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
        }
        
        .start-button {
            display: inline-block;
            padding: 1.5rem 3rem;
            background: rgba(57, 255, 20, 0.2);
            color: var(--neon-green);
            text-decoration: none;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            border: 3px solid var(--neon-green);
            box-shadow: 0 0 20px var(--neon-green);
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
            text-shadow: 0 0 10px var(--neon-green);
            margin: 1rem;
        }
        
        .start-button:hover {
            background: var(--neon-green);
            color: var(--dark-bg);
            text-shadow: none;
            transform: scale(1.1);
            box-shadow: 0 0 40px var(--neon-green), 0 0 80px var(--neon-green);
        }
        
        #gameOver {
            display: none;
            text-align: center;
            font-family: 'Press Start 2P', cursive;
            font-size: 2rem;
            color: var(--neon-pink);
            text-shadow: 0 0 20px var(--neon-pink);
            margin: 2rem 0;
            animation: blink 1s infinite;
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">HOME</a></li>
            <li><a href="missions.html">MISSIONS</a></li>
            <li><a href="planets.html">PLANETS</a></li>
            <li><a href="technology.html">TECH</a></li>
            <li><a href="game.html">GAME</a></li>
            <li><a href="contact.html">CONTACT</a></li>
        </ul>
    </nav>

    <div class="hero">
        <h1>SPACE INVADERS</h1>
        <p class="subtitle">BONUS STAGE UNLOCKED</p>
    </div>

    <div class="container">
        <div class="content-box">
            <h2>ARCADE MODE ACTIVATED</h2>
            <p style="text-align: center;">
                Alright, time for the bonus stage! Defend Earth from the aliens. Use arrow keys to move, 
                spacebar to shoot. Destroy all the aliens before they reach the bottom. Hide behind the 
                shields but they'll break down over time. Let's go!
            </p>

            <div class="game-info">
                <div>SCORE: <span id="score">0</span></div>
                <div>LIVES: <span id="lives">3</span></div>
                <div>LEVEL: <span id="level">1</span></div>
            </div>

            <div class="game-controls">
                <button class="start-button" onclick="startGame()">START GAME</button>
                <button class="start-button" onclick="resetGame()">RESTART</button>
            </div>

            <div id="gameOver">GAME OVER<br>PRESS RESTART</div>

            <canvas id="gameCanvas" width="800" height="600"></canvas>

            <div class="image-container" style="margin-top: 3rem;">
                <img src="https://images.unsplash.com/photo-1511512578047-dfb367046420?w=1200&h=400&fit=crop" alt="Retro space invaders aesthetic">
            </div>

            <h3>HOW TO PLAY</h3>
            <ul class="styled-list">
                <li>LEFT/RIGHT arrows to move your ship</li>
                <li>SPACEBAR to fire (watch the cooldown!)</li>
                <li>Kill all aliens before they reach the bottom</li>
                <li>Hide behind shields - they break down from hits</li>
                <li>Different alien types are worth different points</li>
                <li>Each level adds new alien types and gets tougher</li>
            </ul>
        </div>

        <div class="content-box">
            <a href="index.html" class="home-button">â—„ BACK TO HOME</a>
        </div>
    </div>

    <footer>
        <p>Â© 2025 RETRO SPACE ARCADE | NSI PROJECT made by Nedraw</p>
        <p>INSERT COIN TO CONTINUE</p>
    </footer>

    <script src="animations.js"></script>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameRunning = false;
        let score = 0;
        let lives = 3;
        let level = 1;
        
        // FPS independent timing
        let lastTime = 0;
        const TARGET_FPS = 60;
        const TARGET_FRAME_TIME = 1000 / TARGET_FPS;
        
        // Player
        let player = {
            x: canvas.width / 2 - 25,
            y: canvas.height - 60,
            width: 50,
            height: 30,
            speed: 300, // pixels per second
            dx: 0
        };
        
        // Shooting cooldown
        let canShoot = true;
        let shootCooldown = 500; // ms
        let lastShootTime = 0;
        
        // Bullets
        let bullets = [];
        let bulletSpeed = 400; // pixels per second
        
        // Alien types - different scores and appearances
        const ALIEN_TYPES = {
            BASIC: { points: 10, color: '#39FF14', health: 1 },
            FAST: { points: 20, color: '#FFFF00', health: 1 },
            TANK: { points: 30, color: '#FF6600', health: 2 },
            BOSS: { points: 50, color: '#FF10F0', health: 3 }
        };
        
        // Aliens
        let aliens = [];
        let alienSpeed = 50; // pixels per second
        let alienDirection = 1;
        let alienBombs = [];
        let alienMoveTimer = 0;
        let alienMoveInterval = 500; // ms between moves
        
        // Shields
        let shields = [];
        const SHIELD_WIDTH = 80;
        const SHIELD_HEIGHT = 60;
        const SHIELD_BLOCK_SIZE = 4;
        
        // Keys
        let keys = {};
        
        // Create shields
        function createShields() {
            shields = [];
            const shieldY = canvas.height - 120;
            const spacing = canvas.width / 4;
            
            for (let i = 0; i < 3; i++) {
                let shield = {
                    x: spacing * (i + 1) - SHIELD_WIDTH / 2,
                    y: shieldY,
                    blocks: []
                };
                
                // Create shield blocks
                for (let row = 0; row < SHIELD_HEIGHT / SHIELD_BLOCK_SIZE; row++) {
                    for (let col = 0; col < SHIELD_WIDTH / SHIELD_BLOCK_SIZE; col++) {
                        // Create dome shape
                        let centerCol = (SHIELD_WIDTH / SHIELD_BLOCK_SIZE) / 2;
                        let distance = Math.abs(col - centerCol);
                        let maxDistance = centerCol;
                        let heightAtCol = Math.sqrt(1 - (distance / maxDistance) ** 2) * (SHIELD_HEIGHT / SHIELD_BLOCK_SIZE);
                        
                        if (row < heightAtCol) {
                            shield.blocks.push({
                                x: col * SHIELD_BLOCK_SIZE,
                                y: row * SHIELD_BLOCK_SIZE,
                                alive: true
                            });
                        }
                    }
                }
                shields.push(shield);
            }
        }
        
        // Initialize aliens with different types
        function createAliens() {
            aliens = [];
            let rows = Math.min(4 + Math.floor(level / 2), 6);
            let cols = 8;
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    let type;
                    // Determine alien type based on row and level
                    if (level >= 5 && row === 0) {
                        type = ALIEN_TYPES.BOSS;
                    } else if (level >= 3 && row < 2) {
                        type = ALIEN_TYPES.TANK;
                    } else if (level >= 2 && row === rows - 1) {
                        type = ALIEN_TYPES.FAST;
                    } else {
                        type = ALIEN_TYPES.BASIC;
                    }
                    
                    aliens.push({
                        x: col * 80 + 50,
                        y: row * 60 + 50,
                        width: 40,
                        height: 30,
                        type: type,
                        health: type.health,
                        maxHealth: type.health,
                        alive: true
                    });
                }
            }
        }
        
        // Draw player
        function drawPlayer() {
            ctx.fillStyle = '#00F0FF';
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#00F0FF';
            ctx.fillRect(player.x, player.y, player.width, player.height);
            ctx.fillRect(player.x + 15, player.y - 10, 20, 10);
            ctx.shadowBlur = 0;
        }
        
        // Draw aliens with different types
        function drawAliens() {
            aliens.forEach(alien => {
                if (alien.alive) {
                    ctx.fillStyle = alien.type.color;
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = alien.type.color;
                    
                    // Draw alien shape
                    ctx.fillRect(alien.x, alien.y, alien.width, alien.height);
                    ctx.fillRect(alien.x + 5, alien.y - 10, 10, 10);
                    ctx.fillRect(alien.x + 25, alien.y - 10, 10, 10);
                    ctx.fillRect(alien.x - 5, alien.y + 15, 10, 10);
                    ctx.fillRect(alien.x + 35, alien.y + 15, 10, 10);
                    
                    // Draw health bar for damaged aliens
                    if (alien.health < alien.maxHealth) {
                        const barWidth = 30;
                        const barHeight = 4;
                        const healthPercent = alien.health / alien.maxHealth;
                        
                        ctx.fillStyle = '#FF0000';
                        ctx.fillRect(alien.x + 5, alien.y - 18, barWidth, barHeight);
                        ctx.fillStyle = '#00FF00';
                        ctx.fillRect(alien.x + 5, alien.y - 18, barWidth * healthPercent, barHeight);
                    }
                    
                    ctx.shadowBlur = 0;
                }
            });
        }
        
        // Draw shields
        function drawShields() {
            ctx.fillStyle = '#00FF00';
            shields.forEach(shield => {
                shield.blocks.forEach(block => {
                    if (block.alive) {
                        ctx.fillRect(
                            shield.x + block.x,
                            shield.y + block.y,
                            SHIELD_BLOCK_SIZE,
                            SHIELD_BLOCK_SIZE
                        );
                    }
                });
            });
        }
        
        // Draw bullets
        function drawBullets() {
            ctx.fillStyle = '#FFFF00';
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#FFFF00';
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, 4, 15);
            });
            ctx.shadowBlur = 0;
        }
        
        // Draw alien bombs
        function drawBombs() {
            ctx.fillStyle = '#FF10F0';
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#FF10F0';
            alienBombs.forEach(bomb => {
                ctx.fillRect(bomb.x, bomb.y, 4, 15);
            });
            ctx.shadowBlur = 0;
        }
        
        // Move player (FPS independent)
        function movePlayer(deltaTime) {
            player.x += player.dx * (deltaTime / 1000);
            
            if (player.x < 0) player.x = 0;
            if (player.x + player.width > canvas.width) {
                player.x = canvas.width - player.width;
            }
        }
        
        // Move aliens (FPS independent)
        function moveAliens(deltaTime) {
            alienMoveTimer += deltaTime;
            
            if (alienMoveTimer >= alienMoveInterval) {
                alienMoveTimer = 0;
                
                let hitEdge = false;
                
                aliens.forEach(alien => {
                    if (alien.alive) {
                        alien.x += alienSpeed * alienDirection;
                        
                        if (alien.x <= 0 || alien.x + alien.width >= canvas.width) {
                            hitEdge = true;
                        }
                        
                        // Check if aliens reached bottom
                        if (alien.y + alien.height >= canvas.height - 60) {
                            gameOver();
                        }
                    }
                });
                
                if (hitEdge) {
                    alienDirection *= -1;
                    aliens.forEach(alien => {
                        if (alien.alive) alien.y += 20;
                    });
                }
            }
        }
        
        // Move bullets (FPS independent)
        function moveBullets(deltaTime) {
            bullets = bullets.filter(bullet => {
                bullet.y -= bulletSpeed * (deltaTime / 1000);
                return bullet.y > 0;
            });
        }
        
        // Move bombs (FPS independent)
        function moveBombs(deltaTime) {
            alienBombs = alienBombs.filter(bomb => {
                bomb.y += 200 * (deltaTime / 1000);
                return bomb.y < canvas.height;
            });
        }
        
        // Alien shooting (FPS independent)
        function alienShoot(deltaTime) {
            const shootChance = 0.0008 * (1 + level * 0.1) * deltaTime;
            
            if (Math.random() < shootChance) {
                let aliveAliens = aliens.filter(a => a.alive);
                if (aliveAliens.length > 0) {
                    let shooter = aliveAliens[Math.floor(Math.random() * aliveAliens.length)];
                    alienBombs.push({
                        x: shooter.x + shooter.width / 2,
                        y: shooter.y + shooter.height
                    });
                }
            }
        }
        
        // Collision detection
        function detectCollisions() {
            // Bullet hits alien
            bullets.forEach((bullet, bIndex) => {
                aliens.forEach(alien => {
                    if (alien.alive &&
                        bullet.x < alien.x + alien.width &&
                        bullet.x + 4 > alien.x &&
                        bullet.y < alien.y + alien.height &&
                        bullet.y + 15 > alien.y) {
                        
                        alien.health--;
                        bullets.splice(bIndex, 1);
                        
                        if (alien.health <= 0) {
                            alien.alive = false;
                            score += alien.type.points;
                            updateScore();
                        }
                    }
                });
            });
            
            // Bullet hits shield
            bullets.forEach((bullet, bIndex) => {
                shields.forEach(shield => {
                    shield.blocks.forEach(block => {
                        if (block.alive &&
                            bullet.x < shield.x + block.x + SHIELD_BLOCK_SIZE &&
                            bullet.x + 4 > shield.x + block.x &&
                            bullet.y < shield.y + block.y + SHIELD_BLOCK_SIZE &&
                            bullet.y + 15 > shield.y + block.y) {
                            block.alive = false;
                            bullets.splice(bIndex, 1);
                        }
                    });
                });
            });
            
            // Bomb hits shield
            alienBombs.forEach((bomb, bIndex) => {
                shields.forEach(shield => {
                    shield.blocks.forEach(block => {
                        if (block.alive &&
                            bomb.x < shield.x + block.x + SHIELD_BLOCK_SIZE &&
                            bomb.x + 4 > shield.x + block.x &&
                            bomb.y < shield.y + block.y + SHIELD_BLOCK_SIZE &&
                            bomb.y + 15 > shield.y + block.y) {
                            block.alive = false;
                            alienBombs.splice(bIndex, 1);
                            
                            // Damage nearby blocks
                            shield.blocks.forEach(nearBlock => {
                                if (nearBlock.alive) {
                                    let dx = Math.abs((shield.x + nearBlock.x) - (shield.x + block.x));
                                    let dy = Math.abs((shield.y + nearBlock.y) - (shield.y + block.y));
                                    if (dx <= SHIELD_BLOCK_SIZE * 2 && dy <= SHIELD_BLOCK_SIZE * 2 && Math.random() < 0.3) {
                                        nearBlock.alive = false;
                                    }
                                }
                            });
                        }
                    });
                });
            });
            
            // Bomb hits player
            alienBombs.forEach((bomb, bIndex) => {
                if (bomb.x < player.x + player.width &&
                    bomb.x + 4 > player.x &&
                    bomb.y < player.y + player.height &&
                    bomb.y + 15 > player.y) {
                    alienBombs.splice(bIndex, 1);
                    lives--;
                    updateLives();
                    if (lives <= 0) {
                        gameOver();
                    }
                }
            });
            
            // Check if all aliens destroyed
            if (aliens.every(alien => !alien.alive)) {
                nextLevel();
            }
        }
        
        // Next level
        function nextLevel() {
            level++;
            alienSpeed += 5;
            alienMoveInterval = Math.max(200, alienMoveInterval - 50);
            updateLevel();
            createAliens();
            createShields();
            bullets = [];
            alienBombs = [];
        }
        
        // Update UI
        function updateScore() {
            document.getElementById('score').textContent = score;
        }
        
        function updateLives() {
            document.getElementById('lives').textContent = lives;
        }
        
        function updateLevel() {
            document.getElementById('level').textContent = level;
        }
        
        // Game over
        function gameOver() {
            gameRunning = false;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        // Clear canvas
        function clear() {
            ctx.fillStyle = '#0a0015';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            ctx.strokeStyle = 'rgba(188, 19, 254, 0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i < canvas.height; i += 20) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }
        }
        
        // Game loop with FPS independence
        function gameLoop(currentTime) {
            if (!gameRunning) return;
            
            const deltaTime = currentTime - lastTime;
            lastTime = currentTime;
            
            // Cap deltaTime to prevent huge jumps
            const cappedDelta = Math.min(deltaTime, TARGET_FRAME_TIME * 3);
            
            clear();
            drawShields();
            drawPlayer();
            drawAliens();
            drawBullets();
            drawBombs();
            
            movePlayer(cappedDelta);
            moveAliens(cappedDelta);
            moveBullets(cappedDelta);
            moveBombs(cappedDelta);
            alienShoot(cappedDelta);
            detectCollisions();
            
            requestAnimationFrame(gameLoop);
        }
        
        // Start game
        function startGame() {
            if (!gameRunning) {
                gameRunning = true;
                lastTime = performance.now();
                document.getElementById('gameOver').style.display = 'none';
                requestAnimationFrame(gameLoop);
            }
        }
        
        // Reset game
        function resetGame() {
            gameRunning = false;
            score = 0;
            lives = 3;
            level = 1;
            alienSpeed = 50;
            alienMoveInterval = 500;
            alienMoveTimer = 0;
            bullets = [];
            alienBombs = [];
            player.x = canvas.width / 2 - 25;
            canShoot = true;
            createAliens();
            createShields();
            updateScore();
            updateLives();
            updateLevel();
            document.getElementById('gameOver').style.display = 'none';
        }
        
        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (keys[e.key]) return; // Prevent key repeat
            keys[e.key] = true;
            
            if (e.key === 'ArrowLeft') {
                player.dx = -player.speed;
            }
            if (e.key === 'ArrowRight') {
                player.dx = player.speed;
            }
            if (e.key === ' ' && gameRunning && canShoot) {
                e.preventDefault();
                const currentTime = performance.now();
                
                if (currentTime - lastShootTime >= shootCooldown) {
                    bullets.push({
                        x: player.x + player.width / 2 - 2,
                        y: player.y
                    });
                    lastShootTime = currentTime;
                    canShoot = false;
                    
                    // Reset cooldown
                    setTimeout(() => {
                        canShoot = true;
                    }, shootCooldown);
                }
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
            
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                player.dx = 0;
            }
        });
        
        // Initialize
        createAliens();
        createShields();
        clear();
        drawShields();
        drawPlayer();
        drawAliens();
    </script>
</body>
</html>
