<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ‘¾ SPACE INVADERS - Retro Space Arcade</title>
    <link rel="stylesheet" href="style.css">
    <style>
        #gameCanvas {
            display: block;
            margin: 2rem auto;
            border: 4px solid var(--neon-cyan);
            box-shadow: 
                0 0 20px var(--neon-cyan),
                0 0 40px var(--neon-cyan),
                inset 0 0 30px rgba(0, 240, 255, 0.2);
            background: #000;
        }
        
        .game-controls {
            text-align: center;
            margin: 2rem 0;
            font-family: 'Press Start 2P', cursive;
        }
        
        .game-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 2rem;
            margin: 2rem 0;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
        }
        
        .game-info div {
            padding: 1rem 2rem;
            background: rgba(0, 240, 255, 0.1);
            border: 3px solid var(--neon-cyan);
            box-shadow: 0 0 15px var(--neon-cyan);
            color: var(--neon-cyan);
            text-shadow: 0 0 10px var(--neon-cyan);
        }
        
        .start-button {
            display: inline-block;
            padding: 1.5rem 3rem;
            background: rgba(57, 255, 20, 0.2);
            color: var(--neon-green);
            text-decoration: none;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            border: 3px solid var(--neon-green);
            box-shadow: 0 0 20px var(--neon-green);
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
            text-shadow: 0 0 10px var(--neon-green);
            margin: 1rem;
        }
        
        .start-button:hover {
            background: var(--neon-green);
            color: var(--dark-bg);
            text-shadow: none;
            transform: scale(1.1);
            box-shadow: 0 0 40px var(--neon-green), 0 0 80px var(--neon-green);
        }
        
        #gameOver {
            display: none;
            text-align: center;
            font-family: 'Press Start 2P', cursive;
            font-size: 2rem;
            color: var(--neon-pink);
            text-shadow: 0 0 20px var(--neon-pink);
            margin: 2rem 0;
            animation: blink 1s infinite;
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">HOME</a></li>
            <li><a href="missions.html">MISSIONS</a></li>
            <li><a href="planets.html">PLANETS</a></li>
            <li><a href="technology.html">TECH</a></li>
            <li><a href="game.html">GAME</a></li>
            <li><a href="contact.html">CONTACT</a></li>
        </ul>
    </nav>

    <div class="hero">
        <h1>SPACE INVADERS</h1>
        <p class="subtitle">BONUS STAGE UNLOCKED</p>
    </div>

    <div class="container">
        <div class="content-box">
            <h2>ARCADE MODE ACTIVATED</h2>
            <p style="text-align: center;">
                Alright, time for the bonus stage! Defend Earth from the aliens. Use arrow keys to move, 
                spacebar to shoot. Destroy all the aliens before they reach the bottom. Hide behind the 
                shields but they'll break down over time. Let's go!
            </p>

            <div class="game-info">
                <div>SCORE: <span id="score">0</span></div>
                <div>LIVES: <span id="lives">3</span></div>
                <div>LEVEL: <span id="level">1</span></div>
            </div>

            <div class="game-controls">
                <button class="start-button" onclick="startGame()">START GAME</button>
                <button class="start-button" onclick="resetGame()">RESTART</button>
            </div>

            <div id="gameOver">GAME OVER<br>PRESS RESTART</div>

            <canvas id="gameCanvas" width="800" height="600"></canvas>

            <div class="image-container" style="margin-top: 3rem;">
                <img src="https://images.unsplash.com/photo-1511512578047-dfb367046420?w=1200&h=400&fit=crop" alt="Retro space invaders aesthetic">
            </div>

            <h3>HOW TO PLAY</h3>
            <ul class="styled-list">
                <li>LEFT/RIGHT arrows to move your ship</li>
                <li>SPACEBAR to fire rapidly</li>
                <li>Kill all aliens before they reach the bottom</li>
                <li>Hide behind shields - they break from bombs but YOUR bullets pass through!</li>
                <li>Watch out for different alien types with unique attacks</li>
                <li>Each level spawns tougher aliens with special abilities</li>
            </ul>

            <h3>ALIEN TYPES</h3>
            <ul class="styled-list">
                <li><strong style="color: #39FF14;">SCOUT (Green)</strong> - Basic alien, shoots regular bombs</li>
                <li><strong style="color: #FFFF00;">SPEEDER (Yellow)</strong> - Moves faster, rapid fire</li>
                <li><strong style="color: #FF6600;">TANK (Orange)</strong> - 3 HP, slow but deadly</li>
                <li><strong style="color: #00FFFF;">SNIPER (Cyan)</strong> - Shoots targeted lasers at you</li>
                <li><strong style="color: #FF10F0;">BOSS (Pink)</strong> - 5 HP, fires spread shots</li>
            </ul>
        </div>

        <div class="content-box">
            <a href="index.html" class="home-button">â—„ BACK TO HOME</a>
        </div>
    </div>

    <footer>
        <p>Â© 2025 RETRO SPACE ARCADE | NSI PROJECT made by Nedraw</p>
        <p>INSERT COIN TO CONTINUE</p>
    </footer>

    <script src="animations.js"></script>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameRunning = false;
        let score = 0;
        let lives = 3;
        let level = 1;
        
        // FPS independent timing
        let lastTime = 0;
        const TARGET_FPS = 60;
        const TARGET_FRAME_TIME = 1000 / TARGET_FPS;
        
        // Player
        let player = {
            x: canvas.width / 2 - 25,
            y: canvas.height - 60,
            width: 50,
            height: 30,
            speed: 350,
            dx: 0
        };
        
        // Shooting cooldown - MUCH FASTER NOW
        let canShoot = true;
        let shootCooldown = 250; // 250ms = 4 shots per second
        let lastShootTime = 0;
        
        // Bullets
        let bullets = [];
        let bulletSpeed = 500;
        
        // Alien types with weights and abilities
        const ALIEN_TYPES = {
            SCOUT: {
                name: 'SCOUT',
                points: 10,
                color: '#39FF14',
                health: 1,
                weight: 100, // Most common
                shootRate: 0.0005,
                bombType: 'normal',
                speedMultiplier: 1
            },
            SPEEDER: {
                name: 'SPEEDER',
                points: 20,
                color: '#FFFF00',
                health: 1,
                weight: 50,
                shootRate: 0.001, // Shoots twice as fast
                bombType: 'fast',
                speedMultiplier: 1.5
            },
            TANK: {
                name: 'TANK',
                points: 40,
                color: '#FF6600',
                health: 3,
                weight: 30,
                shootRate: 0.0003,
                bombType: 'heavy',
                speedMultiplier: 0.7
            },
            SNIPER: {
                name: 'SNIPER',
                points: 50,
                color: '#00FFFF',
                health: 2,
                weight: 20,
                shootRate: 0.0004,
                bombType: 'laser', // Aims at player
                speedMultiplier: 1
            },
            BOSS: {
                name: 'BOSS',
                points: 100,
                color: '#FF10F0',
                health: 5,
                weight: 5, // Very rare
                shootRate: 0.0008,
                bombType: 'spread', // Shoots 3 bombs
                speedMultiplier: 0.8
            }
        };
        
        // Aliens
        let aliens = [];
        let alienSpeed = 50;
        let alienDirection = 1;
        let alienBombs = [];
        let alienMoveTimer = 0;
        let alienMoveInterval = 500;
        
        // Shields
        let shields = [];
        const SHIELD_WIDTH = 80;
        const SHIELD_HEIGHT = 60;
        const SHIELD_BLOCK_SIZE = 4;
        
        // Keys
        let keys = {};
        
        // Weighted random alien type selection
        function getRandomAlienType(currentLevel) {
            const types = Object.values(ALIEN_TYPES);
            
            // Adjust weights based on level
            let weightedTypes = [];
            types.forEach(type => {
                // Calculate adjusted weight: higher level = more likely to get rare aliens
                let adjustedWeight = type.weight;
                
                // Reduce weight of common aliens as level increases
                if (type.name === 'SCOUT') {
                    adjustedWeight = Math.max(20, type.weight - (currentLevel * 5));
                }
                
                // Increase weight of rare aliens as level increases
                if (type.name === 'BOSS') {
                    adjustedWeight = type.weight + (currentLevel * 2);
                }
                if (type.name === 'SNIPER') {
                    adjustedWeight = type.weight + (currentLevel * 3);
                }
                if (type.name === 'TANK') {
                    adjustedWeight = type.weight + (currentLevel * 4);
                }
                
                // Add type multiple times based on weight
                for (let i = 0; i < adjustedWeight; i++) {
                    weightedTypes.push(type);
                }
            });
            
            return weightedTypes[Math.floor(Math.random() * weightedTypes.length)];
        }
        
        // Create shields
        function createShields() {
            shields = [];
            const shieldY = canvas.height - 120;
            const spacing = canvas.width / 4;
            
            for (let i = 0; i < 3; i++) {
                let shield = {
                    x: spacing * (i + 1) - SHIELD_WIDTH / 2,
                    y: shieldY,
                    blocks: []
                };
                
                // Create shield blocks in dome shape
                for (let row = 0; row < SHIELD_HEIGHT / SHIELD_BLOCK_SIZE; row++) {
                    for (let col = 0; col < SHIELD_WIDTH / SHIELD_BLOCK_SIZE; col++) {
                        let centerCol = (SHIELD_WIDTH / SHIELD_BLOCK_SIZE) / 2;
                        let distance = Math.abs(col - centerCol);
                        let maxDistance = centerCol;
                        let heightAtCol = Math.sqrt(1 - (distance / maxDistance) ** 2) * (SHIELD_HEIGHT / SHIELD_BLOCK_SIZE);
                        
                        if (row < heightAtCol) {
                            shield.blocks.push({
                                x: col * SHIELD_BLOCK_SIZE,
                                y: row * SHIELD_BLOCK_SIZE,
                                alive: true
                            });
                        }
                    }
                }
                shields.push(shield);
            }
        }
        
        // Initialize aliens with weighted random types
        function createAliens() {
            aliens = [];
            let rows = Math.min(4 + Math.floor(level / 3), 7);
            let cols = 8;
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    let type = getRandomAlienType(level);
                    
                    aliens.push({
                        x: col * 80 + 50,
                        y: row * 60 + 50,
                        width: 40,
                        height: 30,
                        type: type,
                        health: type.health,
                        maxHealth: type.health,
                        alive: true,
                        lastShootTime: 0
                    });
                }
            }
        }
        
        // Draw player
        function drawPlayer() {
            ctx.fillStyle = '#00F0FF';
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#00F0FF';
            ctx.fillRect(player.x, player.y, player.width, player.height);
            ctx.fillRect(player.x + 15, player.y - 10, 20, 10);
            ctx.shadowBlur = 0;
        }
        
        // Draw aliens with their unique colors
        function drawAliens() {
            aliens.forEach(alien => {
                if (alien.alive) {
                    ctx.fillStyle = alien.type.color;
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = alien.type.color;
                    
                    // Different shapes for different types
                    if (alien.type.name === 'BOSS') {
                        // Bigger, meaner looking
                        ctx.fillRect(alien.x - 5, alien.y, alien.width + 10, alien.height);
                        ctx.fillRect(alien.x, alien.y - 10, 15, 10);
                        ctx.fillRect(alien.x + 25, alien.y - 10, 15, 10);
                        ctx.fillRect(alien.x - 10, alien.y + 15, 15, 10);
                        ctx.fillRect(alien.x + 35, alien.y + 15, 15, 10);
                    } else if (alien.type.name === 'TANK') {
                        // Bulkier
                        ctx.fillRect(alien.x, alien.y, alien.width, alien.height + 5);
                        ctx.fillRect(alien.x + 5, alien.y - 8, 10, 10);
                        ctx.fillRect(alien.x + 25, alien.y - 8, 10, 10);
                        ctx.fillRect(alien.x - 5, alien.y + 15, 10, 10);
                        ctx.fillRect(alien.x + 35, alien.y + 15, 10, 10);
                    } else {
                        // Standard shape
                        ctx.fillRect(alien.x, alien.y, alien.width, alien.height);
                        ctx.fillRect(alien.x + 5, alien.y - 10, 10, 10);
                        ctx.fillRect(alien.x + 25, alien.y - 10, 10, 10);
                        ctx.fillRect(alien.x - 5, alien.y + 15, 10, 10);
                        ctx.fillRect(alien.x + 35, alien.y + 15, 10, 10);
                    }
                    
                    // Draw health bar for damaged aliens
                    if (alien.health < alien.maxHealth) {
                        const barWidth = 30;
                        const barHeight = 4;
                        const healthPercent = alien.health / alien.maxHealth;
                        
                        ctx.shadowBlur = 0;
                        ctx.fillStyle = '#FF0000';
                        ctx.fillRect(alien.x + 5, alien.y - 18, barWidth, barHeight);
                        ctx.fillStyle = '#00FF00';
                        ctx.fillRect(alien.x + 5, alien.y - 18, barWidth * healthPercent, barHeight);
                    }
                    
                    ctx.shadowBlur = 0;
                }
            });
        }
        
        // Draw shields
        function drawShields() {
            ctx.fillStyle = '#00FF00';
            shields.forEach(shield => {
                shield.blocks.forEach(block => {
                    if (block.alive) {
                        ctx.fillRect(
                            shield.x + block.x,
                            shield.y + block.y,
                            SHIELD_BLOCK_SIZE,
                            SHIELD_BLOCK_SIZE
                        );
                    }
                });
            });
        }
        
        // Draw bullets
        function drawBullets() {
            ctx.shadowBlur = 15;
            bullets.forEach(bullet => {
                ctx.fillStyle = '#FFFF00';
                ctx.shadowColor = '#FFFF00';
                ctx.fillRect(bullet.x, bullet.y, 4, 15);
            });
            ctx.shadowBlur = 0;
        }
        
        // Draw alien bombs with different visuals
        function drawBombs() {
            ctx.shadowBlur = 15;
            alienBombs.forEach(bomb => {
                if (bomb.type === 'laser') {
                    ctx.fillStyle = '#00FFFF';
                    ctx.shadowColor = '#00FFFF';
                    ctx.fillRect(bomb.x - 1, bomb.y, 6, 20);
                } else if (bomb.type === 'heavy') {
                    ctx.fillStyle = '#FF6600';
                    ctx.shadowColor = '#FF6600';
                    ctx.fillRect(bomb.x - 2, bomb.y, 8, 12);
                } else {
                    ctx.fillStyle = '#FF10F0';
                    ctx.shadowColor = '#FF10F0';
                    ctx.fillRect(bomb.x, bomb.y, 4, 15);
                }
            });
            ctx.shadowBlur = 0;
        }
        
        // Move player
        function movePlayer(deltaTime) {
            player.x += player.dx * (deltaTime / 1000);
            
            if (player.x < 0) player.x = 0;
            if (player.x + player.width > canvas.width) {
                player.x = canvas.width - player.width;
            }
        }
        
        // Move aliens with speed multipliers
        function moveAliens(deltaTime) {
            alienMoveTimer += deltaTime;
            
            if (alienMoveTimer >= alienMoveInterval) {
                alienMoveTimer = 0;
                
                let hitEdge = false;
                
                aliens.forEach(alien => {
                    if (alien.alive) {
                        alien.x += alienSpeed * alienDirection * alien.type.speedMultiplier;
                        
                        if (alien.x <= 0 || alien.x + alien.width >= canvas.width) {
                            hitEdge = true;
                        }
                        
                        if (alien.y + alien.height >= canvas.height - 60) {
                            gameOver();
                        }
                    }
                });
                
                if (hitEdge) {
                    alienDirection *= -1;
                    aliens.forEach(alien => {
                        if (alien.alive) alien.y += 20;
                    });
                }
            }
        }
        
        // Move bullets - PLAYER BULLETS PASS THROUGH SHIELDS!
        function moveBullets(deltaTime) {
            bullets = bullets.filter(bullet => {
                bullet.y -= bulletSpeed * (deltaTime / 1000);
                return bullet.y > 0;
            });
        }
        
        // Move bombs with different speeds
        function moveBombs(deltaTime) {
            alienBombs = alienBombs.filter(bomb => {
                let speed = 200;
                if (bomb.type === 'fast') speed = 300;
                if (bomb.type === 'laser') speed = 350;
                if (bomb.type === 'heavy') speed = 150;
                
                bomb.y += speed * (deltaTime / 1000);
                return bomb.y < canvas.height;
            });
        }
        
        // Alien shooting with unique attacks
        function alienShoot(deltaTime, currentTime) {
            aliens.forEach(alien => {
                if (!alien.alive) return;
                
                const shootChance = alien.type.shootRate * deltaTime;
                
                if (Math.random() < shootChance && currentTime - alien.lastShootTime > 1000) {
                    alien.lastShootTime = currentTime;
                    
                    if (alien.type.bombType === 'spread') {
                        // Boss shoots 3 bombs in spread pattern
                        alienBombs.push({
                            x: alien.x + alien.width / 2,
                            y: alien.y + alien.height,
                            type: alien.type.bombType,
                            dx: 0
                        });
                        alienBombs.push({
                            x: alien.x + alien.width / 2,
                            y: alien.y + alien.height,
                            type: alien.type.bombType,
                            dx: -50
                        });
                        alienBombs.push({
                            x: alien.x + alien.width / 2,
                            y: alien.y + alien.height,
                            type: alien.type.bombType,
                            dx: 50
                        });
                    } else if (alien.type.bombType === 'laser') {
                        // Sniper aims at player
                        alienBombs.push({
                            x: alien.x + alien.width / 2,
                            y: alien.y + alien.height,
                            type: alien.type.bombType,
                            targetX: player.x + player.width / 2,
                            startX: alien.x + alien.width / 2
                        });
                    } else {
                        // Normal bomb
                        alienBombs.push({
                            x: alien.x + alien.width / 2,
                            y: alien.y + alien.height,
                            type: alien.type.bombType,
                            dx: 0
                        });
                    }
                }
            });
        }
        
        // Update bomb positions with special movements
        function updateBombs(deltaTime) {
            alienBombs.forEach(bomb => {
                if (bomb.type === 'laser' && bomb.targetX !== undefined) {
                    // Laser homes in on where player was
                    let direction = bomb.targetX > bomb.startX ? 1 : -1;
                    bomb.x += direction * 100 * (deltaTime / 1000);
                } else if (bomb.dx) {
                    // Spread pattern
                    bomb.x += bomb.dx * (deltaTime / 1000);
                }
            });
        }
        
        // Collision detection
        function detectCollisions() {
            // Bullet hits alien
            bullets.forEach((bullet, bIndex) => {
                aliens.forEach(alien => {
                    if (alien.alive &&
                        bullet.x < alien.x + alien.width &&
                        bullet.x + 4 > alien.x &&
                        bullet.y < alien.y + alien.height &&
                        bullet.y + 15 > alien.y) {
                        
                        alien.health--;
                        bullets.splice(bIndex, 1);
                        
                        if (alien.health <= 0) {
                            alien.alive = false;
                            score += alien.type.points;
                            updateScore();
                        }
                    }
                });
            });
            
            // Bomb hits shield (bullets DON'T hit shields!)
            alienBombs.forEach((bomb, bIndex) => {
                shields.forEach(shield => {
                    shield.blocks.forEach(block => {
                        if (block.alive &&
                            bomb.x < shield.x + block.x + SHIELD_BLOCK_SIZE &&
                            bomb.x + 4 > shield.x + block.x &&
                            bomb.y < shield.y + block.y + SHIELD_BLOCK_SIZE &&
                            bomb.y + 15 > shield.y + block.y) {
                            block.alive = false;
                            alienBombs.splice(bIndex, 1);
                            
                            // Heavy bombs do more damage
                            if (bomb.type === 'heavy') {
                                shield.blocks.forEach(nearBlock => {
                                    if (nearBlock.alive) {
                                        let dx = Math.abs((shield.x + nearBlock.x) - (shield.x + block.x));
                                        let dy = Math.abs((shield.y + nearBlock.y) - (shield.y + block.y));
                                        if (dx <= SHIELD_BLOCK_SIZE * 3 && dy <= SHIELD_BLOCK_SIZE * 3 && Math.random() < 0.5) {
                                            nearBlock.alive = false;
                                        }
                                    }
                                });
                            }
                        }
                    });
                });
            });
            
            // Bomb hits player
            alienBombs.forEach((bomb, bIndex) => {
                if (bomb.x < player.x + player.width &&
                    bomb.x + 4 > player.x &&
                    bomb.y < player.y + player.height &&
                    bomb.y + 15 > player.y) {
                    alienBombs.splice(bIndex, 1);
                    lives--;
                    updateLives();
                    if (lives <= 0) {
                        gameOver();
                    }
                }
            });
            
            // Check if all aliens destroyed
            if (aliens.every(alien => !alien.alive)) {
                nextLevel();
            }
        }
        
        // Next level
        function nextLevel() {
            level++;
            alienSpeed += 3;
            alienMoveInterval = Math.max(150, alienMoveInterval - 30);
            updateLevel();
            createAliens();
            createShields();
            bullets = [];
            alienBombs = [];
        }
        
        // Update UI
        function updateScore() {
            document.getElementById('score').textContent = score;
        }
        
        function updateLives() {
            document.getElementById('lives').textContent = lives;
        }
        
        function updateLevel() {
            document.getElementById('level').textContent = level;
        }
        
        // Game over
        function gameOver() {
            gameRunning = false;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        // Clear canvas
        function clear() {
            ctx.fillStyle = '#0a0015';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            ctx.strokeStyle = 'rgba(188, 19, 254, 0.1)';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i < canvas.height; i += 20) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }
        }
        
        // Game loop
        function gameLoop(currentTime) {
            if (!gameRunning) return;
            
            const deltaTime = currentTime - lastTime;
            lastTime = currentTime;
            const cappedDelta = Math.min(deltaTime, TARGET_FRAME_TIME * 3);
            
            clear();
            drawShields();
            drawPlayer();
            drawAliens();
            drawBullets();
            drawBombs();
            
            movePlayer(cappedDelta);
            moveAliens(cappedDelta);
            moveBullets(cappedDelta);
            moveBombs(cappedDelta);
            updateBombs(cappedDelta);
            alienShoot(cappedDelta, currentTime);
            detectCollisions();
            
            requestAnimationFrame(gameLoop);
        }
        
        // Start game
        function startGame() {
            if (!gameRunning) {
                gameRunning = true;
                lastTime = performance.now();
                document.getElementById('gameOver').style.display = 'none';
                requestAnimationFrame(gameLoop);
            }
        }
        
        // Reset game
        function resetGame() {
            gameRunning = false;
            score = 0;
            lives = 3;
            level = 1;
            alienSpeed = 50;
            alienMoveInterval = 500;
            alienMoveTimer = 0;
            bullets = [];
            alienBombs = [];
            player.x = canvas.width / 2 - 25;
            canShoot = true;
            createAliens();
            createShields();
            updateScore();
            updateLives();
            updateLevel();
            document.getElementById('gameOver').style.display = 'none';
        }
        
        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (keys[e.key]) return;
            keys[e.key] = true;
            
            if (e.key === 'ArrowLeft') {
                player.dx = -player.speed;
            }
            if (e.key === 'ArrowRight') {
                player.dx = player.speed;
            }
            if (e.key === ' ' && gameRunning && canShoot) {
                e.preventDefault();
                const currentTime = performance.now();
                
                if (currentTime - lastShootTime >= shootCooldown) {
                    bullets.push({
                        x: player.x + player.width / 2 - 2,
                        y: player.y
                    });
                    lastShootTime = currentTime;
                    canShoot = false;
                    
                    setTimeout(() => {
                        canShoot = true;
                    }, shootCooldown);
                }
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
            
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                player.dx = 0;
            }
        });
        
        // Initialize
        createAliens();
        createShields();
        clear();
        drawShields();
        drawPlayer();
        drawAliens();
    </script>
</body>
</html>
